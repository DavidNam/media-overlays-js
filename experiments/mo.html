<!doctype html>
<html>
    <head>
        <title>Media Overlays Experiments</title>
        
        <script src="../lib/jquery-1.7.1.min.js"></script>
        <script src="../lib/underscore-min.js"></script>
        <script src="../lib/backbone-min.js"></script>
        
        <script src="../audio-clip-player.js"></script>
        <script src="smil-player.js"></script>
        <script src="mo.js"></script>
        <script>
        
        // a sample starting text position
        var TEXTPOS = "Content/valentinhauy.xhtml#rgn_cnt_0001";
        var OPF = "http://localhost:4000/testdata/valentin/epub/Publication/package.opf";
        
        
        $(document).ready(function() {
            model = new MediaOverlaysModel();
            buttonview = new PlayPauseButton({model: model, el: $("#controls")});  
            textview = new TextArea({model: model, el: $("#textarea")});
        });
        
        PlayPauseButton = Backbone.View.extend({
            loaded: false,
            events: {
                'click #playpause': 'playpause'
            },
            
            initialize: function() {
                var self = this;
                this.model.bind('change:isPlaying', function() {self.render()});
            },
            
            render: function() {
                if (this.model.get("isPlaying")) {
                    $("#playpause").text("pause");
                }
                else {
                    $("#playpause").text("play");
                }
                return this;
            },
            
            playpause: function() {
                if (this.loaded == false) {
                    this.loaded = true;
                    this.model.setPackageFile(OPF);
                    this.model.playTextUrl(TEXTPOS);
                }
                else {
                    if (this.model.get("isPlaying")) {
                        this.model.pause();
                    }
                    else {
                        this.model.resume();
                    }
                }
            }
        });
        
        

        TextArea = Backbone.View.extend({
            initialize: function() {
                var self = this;
                this.model.bind('change:currentTextUrl', function() {self.render()});
                this.model.bind('change:isDocumentDone', function() {self.done()});
            },
           
           render: function() {
               $(this.el).append("<p>" + this.model.get("currentTextUrl") + "</p>");
           }
        });
        
        
       
                 
        </script>
    </head>
    <body id="view">
        <h1>Media Overlays Playback Simulation</h1>
        <div id="controls"><button id="playpause">play</button></div>
        <div id="textarea"></div>
    </body>
</html>